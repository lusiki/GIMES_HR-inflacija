"Vlad[aeiou] RH|Vlad[aeiou] Republike Hrvatske|",
"Hrvatska narodna banka|Dr[zž]avn[io] zavod za statistiku|",
"Hrvatska gospodarska komora|",
"Ministarstvo gospodar|Ministarstvo financij|",
# Cities (major ones)
"Zagreb|Split|Rijeka|Osijek|Zadar|Pula|Slavonski Brod|",
"Karlovac|Vara[zž]din|[SŠ]ibenik|Dubrovnik|",
# Currency/Economic terms
"\\beuro?[aeimu]?\\b.*\\bHrvatsk|Hrvatska.*\\beuro?[aeimu]?\\b|",
"\\bkun[aeiou]?[mj]?\\b|kunama|",
# Regional
"\\bu nas\\b|kod nas|na[sš][aeiou]? tr[zž]i[sš]|hrvatsk[aeiou]? tr[zž]i[sš]|",
"doma[cć][aeiou]? tr[zž]i[sš]|doma[cć][aeiou]? gospodar|",
"hrvatsk[aeiou]? gospodar|hrvatsk[aeiou]? ekonomij|",
# Comparative
"\\bEU prosjek|europski prosjek.*Hrvatska|Hrvatska.*europski prosjek|",
"regij[aeiou]? .* Hrvatska|Hrvatska .* regij",
")"
)
dt[, croatian_context := stri_detect_regex(FULL_TEXT, croatian_pattern, case_insensitive = TRUE)]
message("Articles WITH Croatian context: ", format(sum(dt$croatian_context), big.mark = ","))
message("Articles WITHOUT Croatian context: ", format(sum(!dt$croatian_context), big.mark = ","))
dt <- dt[croatian_context == TRUE]
message("After Croatian context filter: ", format(nrow(dt), big.mark = ","))
# ------------------------------------------------------------------------------
# FINAL DATASET
# ------------------------------------------------------------------------------
message("\n", strrep("=", 80))
message("FINAL RESULTS")
message(strrep("=", 80))
message("\nFinal article count: ", format(nrow(dt), big.mark = ","))
message("\nBy source category:")
print(dt[, .N, by = source_category][order(-N)])
message("\nTop 15 sources:")
print(head(sort(table(dt$FROM), decreasing = TRUE), 15))
message("\nBy year:")
dt[, year := format(as.Date(DATE), "%Y")]
print(dt[, .N, by = year][order(year)])
# ------------------------------------------------------------------------------
# QUALITY CONTROL - SAMPLE TITLES
# ------------------------------------------------------------------------------
message("\n", strrep("=", 80))
message("QUALITY CONTROL - 20 RANDOM TITLES")
message(strrep("=", 80))
set.seed(123)
sample_idx <- sample(nrow(dt), min(20, nrow(dt)))
for(i in seq_along(sample_idx)) {
idx <- sample_idx[i]
message(sprintf("%2d. [%s] %s", i, dt$FROM[idx], substr(dt$TITLE[idx], 1, 80)))
}
# ------------------------------------------------------------------------------
# EXTRACT MATCHED WORDS FOR QC
# ------------------------------------------------------------------------------
message("\n=== EXTRACTING MATCHED TERMS ===")
extract_words <- function(text, pattern) {
matches <- stri_extract_all_regex(text, pattern, case_insensitive = TRUE)
sapply(matches, function(x) paste(unique(na.omit(x)), collapse = "; "))
}
dt[, matched_terms := extract_words(FULL_TEXT, core_pattern)]
# Word frequency
message("\nTop 20 matched terms:")
all_words <- unlist(stri_split_fixed(dt$matched_terms, "; "))
all_words <- all_words[all_words != ""]
all_words <- tolower(all_words)
freq <- sort(table(all_words), decreasing = TRUE)
print(head(freq, 20))
# ------------------------------------------------------------------------------
# SAVE
# ------------------------------------------------------------------------------
message("\n=== SAVING ===")
# Select final columns
dt_final <- dt[, .(
DATE,
FROM,
URL,
TITLE,
FULL_TEXT,
MENTION_SNIPPET,
SOURCE_TYPE,
AUTHOR,
source_category,
text_length,
matched_terms,
REACH,
INTERACTIONS
)]
# Save RDS
write_path_rds <- "C:/Users/lsikic/Desktop/activity_filtered.rds"
saveRDS(dt_final, write_path_rds)
message("Saved RDS: ", write_path_rds)
# Save Excel for QC
library(openxlsx)
write_path_xlsx <- "C:/Users/lsikic/Desktop/activity_filtered.xlsx"
dt_excel <- copy(dt_final)
message("Saving all ", format(nrow(dt_excel), big.mark = ","), " rows to Excel...")
# Truncate FULL_TEXT for Excel (too large)
dt_excel[, FULL_TEXT := substr(FULL_TEXT, 1, 500)]
write.xlsx(dt_excel, write_path_xlsx, overwrite = TRUE)
message("Saved Excel: ", write_path_xlsx)
message("\n=== DONE ===")
View(dt_final)
rm(activity_articles)
View(dt_final)
library(eurostat)
get_eurostat_data <- function() {
result <- list()
# 1. BDP kvartalni (Y/Y rast)
tryCatch({
gdp <- get_eurostat("namq_10_gdp",
filters = list(geo = "HR",
unit = "CLV_PCH_PRE",
s_adj = "SCA",
na_item = "B1GQ"),
time_format = "date")
setDT(gdp)
result$gdp <- gdp[time >= "2021-01-01", .(yearquarter = time, gdp_yoy = values)]
}, error = function(e) message("GDP download failed: ", e$message))
# 2. Industrijska proizvodnja (mjesečno, Y/Y)
tryCatch({
ind <- get_eurostat("sts_inpr_m",
filters = list(geo = "HR",
unit = "PCH_SM",
s_adj = "SCA",
nace_r2 = "B-D"),
time_format = "date")
setDT(ind)
result$industrial <- ind[time >= "2021-01-01", .(yearmonth = time, ind_prod_yoy = values)]
}, error = function(e) message("Industrial production download failed: ", e$message))
# 3. Građevinarstvo (mjesečno, Y/Y)
tryCatch({
con <- get_eurostat("sts_copr_m",
filters = list(geo = "HR",
unit = "PCH_SM",
s_adj = "SCA",
nace_r2 = "F"),
time_format = "date")
setDT(con)
result$construction <- con[time >= "2021-01-01", .(yearmonth = time, construction_yoy = values)]
}, error = function(e) message("Construction download failed: ", e$message))
# 4. Maloprodaja (mjesečno, Y/Y)
tryCatch({
ret <- get_eurostat("sts_trtu_m",
filters = list(geo = "HR",
unit = "PCH_SM",
s_adj = "SCA",
nace_r2 = "G47"),
time_format = "date")
setDT(ret)
result$retail <- ret[time >= "2021-01-01", .(yearmonth = time, retail_yoy = values)]
}, error = function(e) message("Retail download failed: ", e$message))
# 5. Zaposlenost
tryCatch({
emp <- get_eurostat("namq_10_a10_e",
filters = list(geo = "HR",
unit = "PCH_PRE_PER",
s_adj = "SCA",
na_item = "EMP_DC",
nace_r2 = "TOTAL"),
time_format = "date")
setDT(emp)
result$employment <- emp[time >= "2021-01-01", .(yearquarter = time, empl_yoy = values)]
}, error = function(e) message("Employment download failed: ", e$message))
# 6. Nezaposlenost (mjesečno)
tryCatch({
unemp <- get_eurostat("une_rt_m",
filters = list(geo = "HR",
unit = "PC_ACT",
s_adj = "SA",
age = "TOTAL",
sex = "T"),
time_format = "date")
setDT(unemp)
result$unemployment <- unemp[time >= "2021-01-01", .(yearmonth = time, unemp_rate = values)]
}, error = function(e) message("Unemployment download failed: ", e$message))
# 7. Sentiment indikatori (ESI)
tryCatch({
esi <- get_eurostat("ei_bssi_m_r2",
filters = list(geo = "HR",
indic = "BS-ESI-I",
s_adj = "SA"),
time_format = "date")
setDT(esi)
result$esi <- esi[time >= "2021-01-01", .(yearmonth = time, esi = values)]
}, error = function(e) message("ESI download failed: ", e$message))
return(result)
}
eurostat_data <- get_eurostat_data()
library(data.table)
get_eurostat_data <- function() {
result <- list()
# 1. BDP kvartalni (Y/Y rast)
tryCatch({
gdp <- get_eurostat("namq_10_gdp",
filters = list(geo = "HR",
unit = "CLV_PCH_PRE",
s_adj = "SCA",
na_item = "B1GQ"),
time_format = "date")
setDT(gdp)
result$gdp <- gdp[time >= "2021-01-01", .(yearquarter = time, gdp_yoy = values)]
}, error = function(e) message("GDP download failed: ", e$message))
# 2. Industrijska proizvodnja (mjesečno, Y/Y)
tryCatch({
ind <- get_eurostat("sts_inpr_m",
filters = list(geo = "HR",
unit = "PCH_SM",
s_adj = "SCA",
nace_r2 = "B-D"),
time_format = "date")
setDT(ind)
result$industrial <- ind[time >= "2021-01-01", .(yearmonth = time, ind_prod_yoy = values)]
}, error = function(e) message("Industrial production download failed: ", e$message))
# 3. Građevinarstvo (mjesečno, Y/Y)
tryCatch({
con <- get_eurostat("sts_copr_m",
filters = list(geo = "HR",
unit = "PCH_SM",
s_adj = "SCA",
nace_r2 = "F"),
time_format = "date")
setDT(con)
result$construction <- con[time >= "2021-01-01", .(yearmonth = time, construction_yoy = values)]
}, error = function(e) message("Construction download failed: ", e$message))
# 4. Maloprodaja (mjesečno, Y/Y)
tryCatch({
ret <- get_eurostat("sts_trtu_m",
filters = list(geo = "HR",
unit = "PCH_SM",
s_adj = "SCA",
nace_r2 = "G47"),
time_format = "date")
setDT(ret)
result$retail <- ret[time >= "2021-01-01", .(yearmonth = time, retail_yoy = values)]
}, error = function(e) message("Retail download failed: ", e$message))
# 5. Zaposlenost
tryCatch({
emp <- get_eurostat("namq_10_a10_e",
filters = list(geo = "HR",
unit = "PCH_PRE_PER",
s_adj = "SCA",
na_item = "EMP_DC",
nace_r2 = "TOTAL"),
time_format = "date")
setDT(emp)
result$employment <- emp[time >= "2021-01-01", .(yearquarter = time, empl_yoy = values)]
}, error = function(e) message("Employment download failed: ", e$message))
# 6. Nezaposlenost (mjesečno)
tryCatch({
unemp <- get_eurostat("une_rt_m",
filters = list(geo = "HR",
unit = "PC_ACT",
s_adj = "SA",
age = "TOTAL",
sex = "T"),
time_format = "date")
setDT(unemp)
result$unemployment <- unemp[time >= "2021-01-01", .(yearmonth = time, unemp_rate = values)]
}, error = function(e) message("Unemployment download failed: ", e$message))
# 7. Sentiment indikatori (ESI)
tryCatch({
esi <- get_eurostat("ei_bssi_m_r2",
filters = list(geo = "HR",
indic = "BS-ESI-I",
s_adj = "SA"),
time_format = "date")
setDT(esi)
result$esi <- esi[time >= "2021-01-01", .(yearmonth = time, esi = values)]
}, error = function(e) message("ESI download failed: ", e$message))
return(result)
}
eurostat_data <- get_eurostat_data()
library(ggplot2)
library(gridExtra)
plot_list <- list()
if (!is.null(eurostat_data$gdp)) {
p1 <- ggplot(eurostat_data$gdp, aes(x = yearquarter, y = gdp_yoy)) +
geom_line(color = "blue") +
geom_point(color = "blue") +
labs(title = "GDP Growth (Y/Y)", x = "Year-Quarter", y = "GDP Growth (%)") +
theme_minimal()
plot_list[[length(plot_list) + 1]] <- p1
}
if (!is.null(eurostat_data$industrial)) {
p2 <- ggplot(eurostat_data$industrial, aes(x = yearmonth, y = ind_prod_yoy)) +
geom_line(color = "red") +
geom_point(color = "red") +
labs(title = "Industrial Production (Y/Y)", x = "Year-Month", y = "Industrial Production (%)") +
theme_minimal()
plot_list[[length(plot_list) + 1]] <- p2
}
if (!is.null(eurostat_data$construction)) {
p3 <- ggplot(eurostat_data$construction, aes(x = yearmonth, y = construction_yoy)) +
geom_line(color = "green") +
geom_point(color = "green") +
labs(title = "Construction Output (Y/Y)", x = "Year-Month", y = "Construction Output (%)") +
theme_minimal()
plot_list[[length(plot_list) + 1]] <- p3
}
if (!is.null(eurostat_data$retail)) {
p4 <- ggplot(eurostat_data$retail, aes(x = yearmonth, y = retail_yoy)) +
geom_line(color = "purple") +
geom_point(color = "purple") +
labs(title = "Retail Trade (Y/Y)", x = "Year-Month", y = "Retail Trade (%)") +
theme_minimal()
plot_list[[length(plot_list) + 1]] <- p4
}
if (!is.null(eurostat_data$employment)) {
p5 <- ggplot(eurostat_data$employment, aes(x = yearquarter, y = empl_yoy)) +
geom_line(color = "orange") +
geom_point(color = "orange") +
labs(title = "Employment Growth (Y/Y)", x = "Year-Quarter", y = "Employment Growth (%)") +
theme_minimal()
plot_list[[length(plot_list) + 1]] <- p5
}
if (!is.null(eurostat_data$unemployment)) {
p6 <- ggplot(eurostat_data$unemployment, aes(x = yearmonth, y = unemp_rate)) +
geom_line(color = "brown") +
geom_point(color = "brown") +
labs(title = "Unemployment Rate", x = "Year-Month", y = "Unemployment Rate (%)") +
theme_minimal()
plot_list[[length(plot_list) + 1]] <- p6
}
if (!is.null(eurostat_data$esi)) {
p7 <- ggplot(eurostat_data$esi, aes(x = yearmonth, y = esi)) +
geom_line(color = "cyan") +
geom_point(color = "cyan") +
labs(title = "Economic Sentiment Indicator (ESI)", x = "Year-Month", y = "ESI") +
theme_minimal()
plot_list[[length(plot_list) + 1]] <- p7
}
do.call("grid.arrange", c(plot_list, ncol = 2))
# ==============================================================================
# GEOPOLITICAL STABILITY ARTICLE SEARCH - REGEX VERSION
# ==============================================================================
library(duckdb)
library(DBI)
# ------------------------------------------------------------------------------
# CONNECTION
# ------------------------------------------------------------------------------
duckdb_file_path <- "C:/Users/lsikic/Luka C/DetermDB/determDB.duckdb"
con <- dbConnect(duckdb::duckdb(), dbdir = duckdb_file_path, read_only = TRUE)
dbExecute(con, "SET memory_limit='48GB';")
message("Connected to database")
# ------------------------------------------------------------------------------
# GEOPOLITICAL REGEX PATTERN
# ------------------------------------------------------------------------------
geopolitical_regex <- paste0(
"(",
# === NATO/COLLECTIVE DEFENSE ===
"nato.+(vojn|obran|[cč]lanic|pro[sš]irenj|misij|snag|kontingent|vje[zž]b)|",
"(vojn|obran|[cč]lanic|pro[sš]irenj|kontingent).+nato|",
"[cč]lanak 5|",
"kolektivn[aeiou]+ obran|",
"sjevernoatlantsk[aeiou]+ (savez|ugovor|vije[cć]e)|",
"euroatlantsk[aeiou]+ (integracij|savezni[sš]tv|suradnj)|",
# === EU SECURITY/FOREIGN POLICY ===
"(eu|europsk[aeiou]+ unij).+(sigurnost|obran|sankcij|vanjsk[aeiou]+ politik)|",
"(sigurnost|obran|sankcij|vanjsk[aeiou]+ politik).+(eu|europsk[aeiou]+ unij)|",
"zajedni[cč]k[aeiou]+ (vanjsk[aeiou]+ i sigurnosn[aeiou]+ politik|sigurnosn[aeiou]+ politik)|",
"europsk[aeiou]+ (obran|vojn)[aeiou]+ (politik|suradnj|snag)|",
# === UN SECURITY ===
"vije[cć][aeu]+ sigurnosti|",
"(un|ujedinjeni narodi).+(rezolucij|misij|sankcij|mirovn)|",
"mirovn[aeiou]+ (snag|misij|operacij)|",
# === RUSSIA GEOPOLITICAL ===
"(rusij|rusk|moskv|kremlj).+(invazij|agresij|prijetn|sankcij|napetost|sukob|vojn|napad)|",
"(invazij|agresij|prijetn|sankcij).+(rusij|rusk)|",
"kremlj.+(najav|prijet|optu[zž]|zahtjev|odluk)|",
"putin.+(najav|prijet|optu[zž]|zahtjev|rat|invazij)|",
# === CHINA GEOPOLITICAL ===
"(kin|peking).+(vojn|prijetn|sankcij|napetost|sukob|tajvan|utjecaj na|teritorijal)|",
"(prijetn|napetost|sukob|trgovinski rat).+(kin|peking)|",
"kinesk[aeiou]+ (vojn|prijetn|ekspanzij|utjecaj)|",
# === USA GEOPOLITICAL ===
"(sad|ameri[cč]k|washington|pentagon|bijel[aeiou]+ ku[cć]).+(vojn|sankcij|prijetn|napad|operacij|strateg)|",
"ameri[cč]k[aeiou]+ (vojsk|sankcij|prijetn|intervencij|udari|strateg)|",
# === UKRAINE CONFLICT ===
"(ukrajin|kijev|donbas|krim).+(rat|invazij|sukob|ofenziv|obran|vojn|napad|oku?pacij)|",
"(rat|invazij|sukob|ofenziv) (u|na|protiv) ukrajin|",
"rusk[aeiou]+ (invazij|agresij) (na|u|protiv) ukrajin|",
"ukrajinsk[aeiou]+ (rat|sukob|front|obran)|",
# === MIDDLE EAST CONFLICTS ===
"(gaza|izrael|hamas|hezbollah|palestin).+(rat|sukob|napad|bombardiranj|ofenziv|prijetn)|",
"(rat|sukob|napad|bombardiranj) (u|na) (gaz|izrael)|",
"bliskoisto[cč]n[aeiou]+ (sukob|rat|kriza|napetost)|",
"(iran|teheran).+(nuklearn|prijetn|sankcij|napad|raket)|",
"irasnk[aeiou]+ nuklearn|",
# === BALKANS GEOPOLITICAL ===
"(srbij|beograd).+(napetost|sukob|provokacij|prijetnj|vojn[aeiou]+ vje[zž]b)|",
"(kosov|pri[sš]tin).+(napetost|sukob|kriza|priznanj|dijalog)|",
"srbij[aeiou]?.+(kosov|pri[sš]tin).+(napetost|sukob|pregovor|dijalog|odnos)|",
"(bih|bosn[aeiou]|republika srpska|dodik).+(kriza|napetost|secesij|destabiliz|prijetn)|",
"balkansk[aeiou]+ (nestabilnost|napetost|kriza)|",
"zapadn[aeiou]+ balkan.+(stabilnost|sigurnost|integracij|pro[sš]irenj)|",
# === HYBRID THREATS ===
"hibridn[aeiou]+ (rat|prijetn|napad|djelovanj)|",
"hibridno ratovanj|",
"cyber (rat|napad|prijetn).+(dr[zž]av|vojn|obavje[sš]tajn|rusij|kin)|",
"kibernetsk[aeiou]+ (napad|prijetn|sigurnost).+(dr[zž]av|vojn)|",
"dezinformacij[aeiou]+.+(rusij|kin|kampanj|ratovanj)|",
"informacijski rat|",
# === NUCLEAR/WMD ===
"nuklearn[aeiou]+ (prijetn|oru[zž]j|program|naouru[zž]|razouru[zž]|proliferacij)|",
"(nuklearn|atomsk)[aeiou]+ (bomb|bojev[aeiou]+ gla|raket)|",
"balisti[cč]k[aeiou]+ raket|",
"(kemijsk|biolo[sš]k)[aeiou]+ oru[zž]j|",
"neproliferacij|",
"razouru[zž]anj|",
# === SANCTIONS ===
"sankcij[aeiou]+.+(rusij|kin|iran|sjevernu koreju|bjelorusij)|",
"(rusij|kin|iran).+sankcij|",
"(ekonomsk|financijsk|trgovinsk)[aeiou]+ sankcij[aeiou]+.+(uvest|pro[sš]iri|poja[cč]a|ukinu)|",
"embargo.+(oru[zž]j|nafta?|plin)|",
"zamrzavanj[aeu]+ imovine|",
# === MILITARY OPERATIONS ===
"vojn[aeiou]+ (operacij|intervencij|akcij|ofenziv|udar)|",
"(vojn|oru[zž]an)[aeiou]+ sukob|",
"oru[zž]an[aeiou]+ (agresij|intervencij)|",
"vojn[aeiou]+ vje[zž]b[aeiou]+.+(nato|rusij|kin|granica)|",
"prisustvo vojnih snaga|",
"raspore[dđ]ivanje (vojsk|trupa|snaga)|",
"vojn[aeiou]+ pomo[cć]|",
"isporuk[aeiou]+ oru[zž]ja|",
# === TERRITORIAL DISPUTES ===
"teritorijaln[aeiou]+ (integritet|sukob|spor|cjelovitost)|",
"oku?pacij[aeiou]+.+(teritorij|podru[cč]j)|",
"(aneksij|pripojenje).+(krim|teritorij)|",
"separatiz[ao]m|",
"secesij[aeiou]?|",
# === DIPLOMATIC INCIDENTS ===
"diplomatsk[aeiou]+ (kriza|incident|sukob|napetost)|",
"protjerivanje diplomat|",
"persona non grata|",
"(povla[cč]enj|opoziv) veleposlanika|",
"zatvaranje (veleposlanstv|ambasad|konzulat)|",
"prekid diplomatskih odnosa|",
# === ALLIANCES/TREATIES (geopolitical) ===
"vojn[aeiou]+ (savez|savezni[sš]tv|pakt)|",
"strate[sš]k[aeiou]+ partnerstvo.+(sad|rusij|kin|nato)|",
"sigurnosn[aeiou]+ (sporazum|ugovor|garancij)|",
"obrambeni sporazum|",
# === INTEGRATION/ENLARGEMENT ===
"pro[sš]irenj[aeu]+ (nato|eu|europsk[aeiou]+ unij)|",
"(pristupanj|[cč]lanstvo).+(nato|eu).+(pregovor|[cč]lan|kandidat)|",
"[cč]lanstv[aou]+ u (nato|eu)|",
"pristupni pregovor|",
"kandidatski status|",
# === GEOPOLITICAL ANALYSIS ===
"geopoliti[cč]k[aeiou]+|",
"me[dđ]unarodn[aeiou]+ (sigurnost|odnos[aei]?|poredak)|",
"globaln[aeiou]+ (sigurnost|poredak|nestabilnost)|",
"ravnote[zž][aeu]? (snaga|mo[cć]i)|",
"sfer[aeu]? utjecaja|",
"multipolarnost|",
"unilateraliz[ao]m|",
# === INTELLIGENCE/ESPIONAGE ===
"[sš]pijuna[zž][aeiou]?|",
"[sš]pijunsk[aeiou]+ (afar|skandal|mre[zž])|",
"obavje[sš]tajn[aeiou]+ (slu[zž]b|operacij|aktivnost).+(stran|rusij|kin)|",
"tajn[aeiou]+ (operacij|misij)|",
# === BORDER SECURITY (geopolitical) ===
"grani[cč]n[aeiou]+ (incident|napetost|sukob|kriza)|",
"kr[sš]enj[aeu]+ (granice|teritorij|zra[cč]nog prostor|suverenitet)|",
"zatvaranje granic[aeiou]+.+(sigurnost|vojn|kriza)|",
")"
)
# ------------------------------------------------------------------------------
# BUILD QUERY
# ------------------------------------------------------------------------------
query <- paste0("
SELECT *
FROM media_data
WHERE DATE >= '2021-01-01'
AND DATE <= '2024-05-31'
AND REGEXP_MATCHES(LOWER(FULL_TEXT), '", tolower(geopolitical_regex), "')
")
# ------------------------------------------------------------------------------
# EXECUTE
# ------------------------------------------------------------------------------
message("Retrieving geopolitical articles using regex pattern...")
message("This searches ~25M rows for matching articles...")
start_time <- Sys.time()
geopolitical_articles <- dbGetQuery(con, query)
elapsed <- round(difftime(Sys.time(), start_time, units = "mins"), 2)
message("Done in ", elapsed, " minutes")
message("Articles retrieved: ", format(nrow(geopolitical_articles), big.mark = ","))
# ------------------------------------------------------------------------------
# QUICK STATS
# ------------------------------------------------------------------------------
if(nrow(geopolitical_articles) > 0) {
message("\n=== QUICK STATS ===")
message("By SOURCE_TYPE:")
print(table(geopolitical_articles$SOURCE_TYPE))
message("\nTop 10 Sources:")
print(head(sort(table(geopolitical_articles$FROM), decreasing = TRUE), 10))
message("\nSample Titles:")
set.seed(123)
sample_idx <- sample(nrow(geopolitical_articles), min(10, nrow(geopolitical_articles)))
for(i in seq_along(sample_idx)) {
message("  ", i, ". ", substr(geopolitical_articles$TITLE[sample_idx[i]], 1, 80))
}
}
# ------------------------------------------------------------------------------
# CLEANUP
# ------------------------------------------------------------------------------
dbDisconnect(con, shutdown = TRUE)
message("\nDatabase connection closed")
# ------------------------------------------------------------------------------
# SAVE
# ------------------------------------------------------------------------------
write_path <- "C:/Users/lsikic/Desktop/geopolitical_articles.rds"
saveRDS(geopolitical_articles, write_path)
